<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>闭包</title>
    </head>
    <body>
        <script>
            /* 
               闭包:
                    形成条件:
                        1. 有函数嵌套.
                        2. 内部函数使用了外部函数的变量. 
                        3. 返回值为函数.
                        4. 创建一个对象接收函数返回值.
                    好处: 
                        1. 延长变量的生命周期, 减少全局变量污染.
                        2. 创建私有变量.
                    缺点:
                        容易造成内存泄漏, 变量没有被垃圾回收机制及时清理.
                    场景:
                        1. 防抖节流, 会在函数中先声明个tiemr,来记录是否已经开启定时器.
                            - 防抖: 每次触发都清空 timer, 然后重新赋值计时.
                            - 节流: 每次触发 判断timer是否有值, 没值的时候再添加定时器, 然后等执行完毕,再将timer清空.
                        2. 第三方包的封装. 他们内部都是 自执行函数, 然后在里面定义变量, return一个对象,属性方法等.
                        3. Vue组件中data是个函数而不是对象.

                    如何清除闭包:
                        将接收闭包返回值的那个变量赋值为 null.
            */

            // function Bb() {
            //     let a = "小明"
            //     return {
            //         b: a
            //     }
            // }
            // const res = Bb()
            // res.b = "小黑"#
            // console.log(res)
            // const res2 = Bb()

            // res2.b = "小美"
            // console.log(res2)
            /*************************/
            const fn = (function () {
                let a = "小明"
                return {
                    b: a
                }
            })()
            const a = fn
            console.log(a)
            a.b = "小黑"
            console.log(a)
            const b = fn
            b.b = "哈哈"
            console.log(b)
            console.log(a)

            /* 
            foo(0) : a:0 b:undefined => undefined
            foo(1) : a:1 b:0 => 0
            foo(2) : a:2 b:1 => 1
         */
        </script>
    </body>
</html>
